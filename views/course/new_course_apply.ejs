<div class="row-fluid">
    <div class="span12">
        <div class="portlet box green">
            <div class="portlet-title">
                <div class="caption">
                    <i class="icon-reorder"></i>
                </div>
                <div class="actions">
                    <a href="/contract/my_contract_list" class="btn yellow"><i class="icon-chevron-left"></i> 返回</a>
                </div>
            </div>
            <div class="portlet-body form">
                <div class="form-horizontal form-view">
                    <h3 class="form-section">新增排课申请</h3>
                    <div class="row-fluid">
                        <div class="span6 ">
                            <div class="control-group">
                                <label class="control-label">合同编号:</label>
                                <div class="controls">
                                    <span class="text bold"><%= contract.contract_no%></span>
                                </div>
                            </div>
                        </div>
                        <div class="span6 ">
                            <div class="control-group">
                                <label class="control-label">合同属性:</label>
                                <div class="controls">
                                    <span class="text bold"><%= attributeMap[contract.attribute_id].name%></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span6 ">
                            <div class="control-group">
                                <label class="control-label">合同类型:</label>
                                <div class="controls">
                                    <span class="text bold"><%= typeMap[contract.contract_type_id].name%></span>
                                </div>
                            </div>
                        </div>
                        <div class="span6 ">
                            <div class="control-group">
                                <label class="control-label">年级:</label>
                                <div class="controls">
                                    <span class="text bold"><%= gradeMap[contract.grade_id].name%></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span6 ">
                            <div class="control-group">
                                <label class="control-label" >合同金额:</label>
                                <div class="controls">
                                    <span class="text bold"><%= contract.total_money%></span>
                                </div>
                            </div>
                        </div>
                        <div class="span6 ">
                            <div class="control-group">
                                <label class="control-label" >已付款:</label>
                                <div class="controls">
                                    <span class="text bold"><%= contract.prepay%></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span6 ">
                            <div class="control-group">
                                <label class="control-label" >未付款:</label>
                                <div class="controls">
                                    <span class="text bold"><%= contract.left_money%></span>
                                </div>
                            </div>
                        </div>
                        <div class="span6 ">
                            <div class="control-group">
                                <label class="control-label" >总课时数:</label>
                                <div class="controls">
                                    <span class="text bold"><%= contract.total_lesson_period%></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span6 ">
                            <div class="control-group">
                                <label class="control-label" >合同开始日期:</label>
                                <div class="controls">
                                    <span class="text bold"><%= dateUtil.dateFormat(contract.start_date)%></span>
                                </div>
                            </div>
                        </div>
                        <div class="span6 ">
                            <div class="control-group">
                                <label class="control-label" >是否推荐:</label>
                                <div class="controls">
                                    <span class="text bold"><%if (contract.is_recommend == 0){%>否<%} else {%>是<%}%></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <%if (contract.is_recommend == 1) {%>
                    <div class="row-fluid">
                        <div class="span6 ">
                            <div class="control-group">
                                <label class="control-label" >推荐方式:</label>
                                <div class="controls">
                                    <span class="text bold"><%= contract.recommend_type%></span>
                                </div>
                            </div>
                        </div>
                        <div class="span6 ">
                            <div class="control-group">
                                <label class="control-label" >推荐人:</label>
                                <div class="controls">
                                    <span class="text bold"><%if (contract.recommender_id) {%><%= userMap[contract.recommender_id].name%><%}%></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <%}%>
                    <div class="row-fluid">
                        <div class="span6 ">
                            <div class="control-group">
                                <label class="control-label" >签约人:</label>
                                <div class="controls">
                                    <span class="text bold"><%= userMap[contract.signer_id].name%></span>
                                </div>
                            </div>
                        </div>
                        <div class="span6 ">
                            <div class="control-group">
                                <label class="control-label" >续费可能性:</label>
                                <div class="controls">
                                    <span class="text bold"><%= possibilityMap[contract.possibility_id].name%></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span6 ">
                            <div class="control-group">
                                <label class="control-label" >合同状态:</label>
                                <div class="controls">
                                    <span class="text bold"><%= statusMap[contract.status_id].name%></span>
                                </div>
                            </div>
                        </div>
                        <div class="span6 ">
                            <div class="control-group">
                                <label class="control-label" >签约时间:</label>
                                <div class="controls">
                                    <span class="text bold"><%= dateUtil.dateFormat(contract.create_at)%></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12 ">
                            <div class="control-group">
                                <label class="control-label" >备注:</label>
                                <div class="controls">
                                    <span class="text bold"><%= contract.note%></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <h3 class="form-section">合同明细</h3>
                    <table class="table table-striped table-hover">
                        <thead>
                        <tr>
                            <th>科目</th>
                            <th>课时</th>
                            <th>已完成课时</th>
                            <th>类型</th>
                            <th>单价</th>
                            <th>状态</th>
                        </tr>
                        </thead>
                        <tbody>
                        <%for (let i = 0; i < contractDetails.length; i++) {%>
                        <tr>
                            <td><%= subjectMap[contractDetails[i].subject_id].name%></td>
                            <td><%= contractDetails[i].lesson_period%></td>
                            <td><%= contractDetails[i].finished_lesson%></td>
                            <td><%= detailTypeMap[contractDetails[i].type_id].name%></td>
                            <td><%= contractDetails[i].price%></td>
                            <td><%= detailStatusMap[contractDetails[i].status_id].name%></td>
                        </tr>
                        <%}%>
                        </tbody>
                    </table>
                </div>
                <form action="/course/do_create_course_apply" method="post" class="form-horizontal" enctype="multipart/form-data">
                    <fieldset>
                    <input name="contract_id" value="<%= contract.id%>" type="hidden">
                    <h3 class="form-section">新增排课申请</h3>
                    <div class="control-group">
                        <label class="control-label">排课文件<span class="required">*</span></label>
                        <div class="controls">
                            <div class="fileupload fileupload-new" data-provides="fileupload">
                                <div class="input-append">
                                    <div class="uneditable-input">
                                        <i class="icon-file fileupload-exists"></i>
                                        <span class="fileupload-preview"></span>
                                    </div>
                                    <span class="btn btn-file">
                                        <span class="fileupload-new">选择文件</span>
                                        <span class="fileupload-exists">变更</span>
                                        <input type="file" class="default" multiple id="file_path" name="file_path" required/>
                                    </span>
                                    <a href="#" class="btn fileupload-exists" data-dismiss="fileupload">移除</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn green"><i class="icon-ok"></i> 提交</button>
                        <button type="button" class="btn" onclick="javascript:history.back(-1);"><i class="icon-remove"></i> 取消</button>
                    </div>
                    </fieldset>
                </form>
            </div>
        </div>
    </div>
</div>
<%- contentFor('title')%>
新增排课申请
<%- contentFor('breadcrumb')%>
<li>
    <i class="icon-angle-right"></i>
    <a href="javascript:void(0);">合同</a>
</li>
<li>
    <i class="icon-angle-right"></i>
    <a href="/contract/my_contract_list">合同管理</a>
</li>
<li>
    <i class="icon-angle-right"></i>
    <a href="/course/new_course_apply?contract_id=<%= contract.id%>">新增排课申请</a>
</li>
<%- contentFor('script')%>
<script>
    $(function() {
        $('form').validate({
            errorClass: 'help-inline', // default input error message class
            errorPlacement: function(error, element) {
                error.appendTo( element.parents('.input-append') );
            },
            highlight: function (element) { // hightlight error inputs
                $(element)
                    .closest('.help-inline').removeClass('ok'); // display OK icon
                $(element)
                    .closest('.control-group').removeClass('success').addClass('error'); // set error class to the control group
            },
            unhighlight: function (element) { // revert the change dony by hightlight
                $(element)
                    .closest('.control-group').removeClass('error'); // set error class to the control group
            },
            success: function (label) {
                label
                    .addClass('valid').addClass('help-inline ok') // mark the current input as valid and display OK icon
                    .closest('.control-group').removeClass('error').addClass('success'); // set success class to the control group
            }
        });
    });
</script>